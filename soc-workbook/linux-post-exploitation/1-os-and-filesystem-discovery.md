# OS and Filesystem Discovery (Linux) – SOC Workbook

After gaining access to a Linux host, attackers need to understand:
- What system they are on
- What privileges they have
- Whether the system is real or a sandbox
- What files and directories exist
- How the environment is configured

This phase informs all later attacker decisions.

### Command
pwd

### What it Does
Prints the current working directory of the user or process.

### Why Attackers Use It
- Understand where they landed after gaining access
- Identify writable directories
- Determine if they are inside sensitive paths

### Example
pwd

Output:
 /home/ubuntu

### SOC Detection
- Low-signal by itself
- Suspicious when executed alongside multiple discovery commands in short time windows
ls / – List Root Filesystem
### Command
ls /

### What it Does
Lists top-level directories on the system.

### Why Attackers Use It
- Identify server role (web server, database, container, etc.)
- Discover mounted volumes
- Identify interesting directories like /home, /var, /opt

### Example
ls /

Output:
 bin  boot  dev  etc  home  lib  var  opt

### SOC Detection
- Often part of early discovery phase
- Correlate with uname, hostname, lsb_release
env – Environment Variables
### Command
env

### What it Does
Displays environment variables for the current session.

### Why Attackers Use It
- Look for credentials stored in environment variables
- Identify application context (containers, CI/CD)
- Discover proxy settings or secrets

### Example
env | grep -i pass

### SOC Detection
- High-value indicator in cloud and CI/CD breaches
- Look for env execution followed by credential harvesting
uname -a – Kernel and OS Info
### Command
uname -a

### What it Does
Displays kernel version, OS type, architecture, and hostname.

### Why Attackers Use It
- Identify kernel vulnerabilities
- Choose appropriate privilege escalation exploits
- Identify target architecture for payloads

### Example
uname -a

Output:
 Linux victim 5.15.0-76-generic x86_64 GNU/Linux

### SOC Detection
- Strong discovery signal when correlated with lsb_release and hostname
lsb_release -a – Distribution Information
### Command
lsb_release -a

### What it Does
Displays Linux distribution name and version.

### Why Attackers Use It
- Tailor payloads and exploits to specific OS versions
- Identify outdated or vulnerable distributions

### Example
lsb_release -a

Output:
 Distributor ID: Ubuntu
 Release: 20.04

### SOC Detection
- Used in vulnerability assessment by attackers
hostname – Host Identification
### Command
hostname

### What it Does
Displays system hostname.

### Why Attackers Use It
- Identify host role (e.g., web01, db-prod)
- Map infrastructure naming conventions

### Example
hostname

Output:
 web-prod-01

### SOC Detection
- Combine with process ancestry and login events

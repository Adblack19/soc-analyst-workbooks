# User, Process, and Network Discovery – SOC Workbook
id / whoami – Identity Discovery
### Commands
id  
whoami

### What They Do
Display the current user and group memberships.

### Why Attackers Use Them
- Determine privilege level
- Check if privilege escalation is required
- Identify lateral movement opportunities

### Example
id

Output:
 uid=1000(ubuntu) gid=1000(ubuntu) groups=1000(ubuntu),27(sudo)

### SOC Detection
- Discovery commands chained after login events
- Strong indicator of post-compromise enumeration
w / last – Session Discovery
### Commands
w  
last

### What They Do
Display active and historical login sessions.

### Why Attackers Use Them
- Identify other logged-in users
- Find high-privilege accounts
- Time attacks to avoid detection

### Example
w

### SOC Detection
- Look for w or last in auditd logs shortly after access
ps aux / top – Process Discovery
### Commands
ps aux  
top

### What They Do
List running processes and resource usage.

### Why Attackers Use Them
- Identify security tools (EDR, monitoring agents)
- Identify high-value applications
- Spot processes to inject into

### Example
ps aux | grep root

### SOC Detection
- Strong discovery indicator
- Commonly followed by credential dumping or tool deployment
ip a / ip r / arp -a / ss -tnlp
### Commands
ip a  
ip r  
arp -a  
ss -tnlp  
netstat -tnlp

### What They Do
Reveal network interfaces, routes, ARP cache, and listening services.

### Why Attackers Use Them
- Map internal network
- Identify pivot opportunities
- Discover exposed services

### SOC Detection
- Network discovery clustered in short time windows
- Correlate with internal scanning activity
